(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{191:function(e,t,n){},269:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),i=n(41),o=n.n(i),s=(n(191),n(1)),r=n.n(s),l=n(2),u=n(277),d=n(272),j=n(273),p=n(83),b=n(115),h=n(181),m=(n(192),n(270),b.a.initializeApp({apiKey:"AIzaSyDAZ0UDDoyO6Q7nUYRjTkAFzGd-C9fOm2Y",authDomain:"chat-app-dbc83.firebaseapp.com",projectId:"chat-app-dbc83",storageBucket:"chat-app-dbc83.appspot.com",messagingSenderId:"656128365474",appId:"1:656128365474:web:c95a0e75be310eb976d8fb",measurementId:"G-3BY0G5VWYJ"}));Object(h.a)(m);var O=b.a.auth(),f=b.a.firestore();"localhost"===window.location.hostname&&(O.useEmulator("http://localhost:9099"),f.useEmulator("127.0.0.1","8080"));var x=b.a,v=n(40),g=n(61);function y(e,t){f.collection(e).add(Object(g.a)(Object(g.a)({},t),{},{createAt:x.firestore.FieldValue.serverTimestamp()}))}var w=function(e){for(var t=e.toLowerCase().split(" ").filter((function(e){return e})),n=t.length,a=[],c=[],i=[],o=0;o<n;o++)a[o]=!1;!function e(o){for(var s=0;s<n;s++)a[s]||(a[s]=!0,c[o]=t[s],o===n-1&&i.push(c.join(" ")),e(o+1),a[s]=!1)}(0);var s=i.reduce((function(e,t){var n=function(e){var t=[],n="";return e.split("").forEach((function(e){n+=e,t.push(n)})),t}(t);return[].concat(Object(v.a)(e),Object(v.a)(n))}),[]);return s},C=n(12),N=u.a.Title,I=new x.auth.FacebookAuthProvider,R=new x.auth.GoogleAuthProvider;var U,k,A,L,F,V,S,T,D,M,z,E=function(){function e(){return(e=Object(l.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.signInWithPopup(I).then((function(e){var t=e.additionalUserInfo,n=e.user;(null===t||void 0===t?void 0:t.isNewUser)&&y("users",{displayName:n.displayName,email:n.email,uid:n.uid,photoURL:n.photoURL,providerID:t.providerId,keywords:w(n.displayName)})})).catch((function(e){console.log(e.message,7e3)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=Object(l.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.signInWithPopup(R).then((function(e){var t=e.additionalUserInfo,n=e.user;(null===t||void 0===t?void 0:t.isNewUser)&&y("users",{displayName:n.displayName,email:n.email,uid:n.uid,photoURL:n.photoURL,providerID:t.providerId,keywords:w(n.displayName)})})).catch((function(e){console.log(e.message,7e3)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(C.jsx)("div",{children:Object(C.jsx)(d.a,{justify:"center",children:Object(C.jsxs)(j.a,{span:6,children:[Object(C.jsx)(N,{style:{textAlign:"center"},level:3,children:"Chat App"}),Object(C.jsx)(p.a,{style:{width:"100%",marginBottom:8},onClick:function(){return t.apply(this,arguments)},children:"Sign in with Google"}),Object(C.jsx)(p.a,{style:{width:"100%"},onClick:function(){return e.apply(this,arguments)},children:"Sign in with FaceBook"})]})})})},P=n(46),B=n(282),G=n(285),K=n(47),Y=n(21),J=n(29),W=n(274),q=Object(K.a)(W.a)(U||(U=Object(P.a)(["\n  display: flex;\n  justify-content: center;\n  margin-top: 100px;\n"]))),H=Object(a.createContext)(),Q=function(e){var t=e.children,n=Object(J.f)(),c=Object(a.useState)({}),i=Object(Y.a)(c,2),o=i[0],s=i[1],r=Object(a.useState)(!0),l=Object(Y.a)(r,2),u=l[0],d=l[1];return Object(a.useEffect)((function(){var e=O.onAuthStateChanged((function(e){if(e){var t=e.email,a=e.displayName,c=e.uid,i=e.photoURL;s({email:t,displayName:a,uid:c,photoURL:i}),d(!1),n("/")}else d(!1),n("/login")}));return function(){e()}}),[n]),Object(C.jsx)(H.Provider,{value:o,children:u?Object(C.jsx)(q,{size:"large"}):t})},Z=K.a.div(k||(k=Object(P.a)(["\n  display: flex;\n  justify-content: space-between;\n  padding: 15px;\n  border-bottom: 1px solid rgba(82, 38, 83);\n  .username {\n    margin-left: 5px;\n    color: white;\n  }\n"]))),X=function(){var e,t=Object(a.useContext)(H),n=t.displayName,c=t.photoURL;return Object(C.jsxs)(Z,{children:[Object(C.jsxs)("div",{children:[Object(C.jsx)(B.a,{className:"avatar",src:c,style:{backgroundColor:"#f56a00"},children:c?"":null===n||void 0===n||null===(e=n.charAt(0))||void 0===e?void 0:e.toUpperCase()}),Object(C.jsx)(u.a.Text,{className:"username",children:n})]}),Object(C.jsx)(p.a,{ghost:!0,icon:Object(C.jsx)(G.a,{}),onClick:function(){O.signOut()},children:"\u0110\u0103ng xu\u1ea5t"})]})},$=n(279),_=n(284),ee=n(8),te=function(e,t){var n=Object(a.useState)([]),c=Object(Y.a)(n,2),i=c[0],o=c[1];return Object(a.useEffect)((function(){var n=f.collection(e).orderBy("createAt");return t&&t.compareValue&&(n=n.where(t.fieldName,t.operator,t.compareValue)),n.onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(g.a)(Object(g.a)({},e.data()),{},Object(ee.a)({},"id",e.id)))})),o([].concat(t))}))}),[e,t]),i},ne=Object(a.createContext)(),ae=function(e){var t=e.children,n=Object(a.useState)(!1),c=Object(Y.a)(n,2),i=c[0],o=c[1],s=Object(a.useState)(!1),r=Object(Y.a)(s,2),l=r[0],u=r[1],d=Object(a.useState)(""),j=Object(Y.a)(d,2),p=j[0],b=j[1],h=Object(a.useContext)(H).uid,m=Object(a.useMemo)((function(){return{fieldName:"members",operator:"array-contains",compareValue:h}}),[h]),O=te("rooms",m),f=Object(a.useMemo)((function(){return O.find((function(e){return e.id===p}))}),[p,O]),x=Object(a.useMemo)((function(){return{fieldName:"uid",operator:"in",compareValue:f?f.members:[""]}}),[f]),v=te("users",x);return Object(C.jsx)(ne.Provider,{value:{rooms:O,users:v,selectedRoom:f,isVisibleAddRoom:i,setIsVisibleAddRoom:o,selectedRoomId:p,setSelectedRoomId:b,isVisibleInviteUser:l,setIsVisibleInviteUser:u},children:t})},ce=Object(K.a)($.a.Panel)(A||(A=Object(P.a)(["\n  &&& {\n    .ant-collapse-header {\n      color: white;\n      padding-bottom: 0;\n    }\n    .ant-typography {\n      display: block;\n      margin: 10px 17px;\n    }\n    .ant-typography:first-child {\n      margin-top: 0;\n    }\n    .ant-collapse-content {\n      padding-left: 7px;\n    }\n    .ant-btn {\n      color: white;\n      &:hover {\n        opacity: 0.8;\n      }\n    }\n  }\n"]))),ie=function(){var e=c.a.useContext(ne),t=e.setIsVisibleAddRoom,n=e.setSelectedRoomId,a=e.rooms;return Object(C.jsx)($.a,{ghost:!0,bordered:!1,defaultActiveKey:["1"],children:Object(C.jsxs)(ce,{header:"Danh s\xe1ch c\xe1c ph\xf2ng",children:[Object(C.jsx)("div",{children:a.map((function(e){return Object(C.jsx)(u.a.Link,{onClick:function(){return t=e.id,void n(t);var t},children:e.name},e.id)}))}),Object(C.jsx)(p.a,{type:"text",onClick:function(){t(!0)},icon:Object(C.jsx)(_.a,{}),children:"Th\xeam ph\xf2ng"})]},"1")})},oe=K.a.div(L||(L=Object(P.a)(["\n  background-color: rgb(63, 14, 64);\n  color: white;\n  height: 100vh;\n"]))),se=function(){return Object(C.jsx)(oe,{children:Object(C.jsxs)(d.a,{children:[Object(C.jsx)(j.a,{span:24,children:Object(C.jsx)(X,{})}),Object(C.jsx)(j.a,{span:24,children:Object(C.jsx)(ie,{})})]})})},re=n(81),le=n(286),ue=K.a.div(F||(F=Object(P.a)(["\n  display: flex;\n  justify-content: space-between;\n  border-bottom: 1px solid rgba(82, 38, 83, 0.1);\n  .header {\n    padding: 5px 10px;\n    .header-title {\n      margin-bottom: 5px;\n    }\n    .header-desc {\n      font-size: 13px;\n    }\n  }\n  .ant-btn {\n    margin-right: 10px;\n  }\n  .user-box {\n    display: flex;\n    align-items: center;\n    .ant-avatar {\n      cursor: pointer;\n    }\n  }\n"]))),de=function(){var e=Object(a.useContext)(ne),t=e.selectedRoom,n=e.users,c=e.setIsVisibleInviteUser,i=t.name,o=t.description;return Object(C.jsxs)(ue,{children:[Object(C.jsxs)("div",{className:"header",children:[Object(C.jsx)(u.a.Title,{className:"header-title",level:4,children:i}),Object(C.jsx)(u.a.Text,{className:"header-desc",children:o})]}),Object(C.jsxs)("div",{className:"user-box",children:[Object(C.jsx)(p.a,{shape:"round",icon:Object(C.jsx)(le.a,{}),onClick:function(){c(!0)},children:"M\u1eddi"}),Object(C.jsx)(B.a.Group,{maxCount:3,children:n.map((function(e){var t;return Object(C.jsx)(re.a,{title:e.displayName,placement:"bottom",children:Object(C.jsx)(B.a,{src:e.photoURL,style:{backgroundColor:"#87d068"},children:e.photoURL?"":null===(t=e.displayName)||void 0===t?void 0:t.charAt(0).toUpperCase()})},e.uid)}))})]})]})},je=n(276),pe=n(281),be=n(275),he=u.a.Text,me=K.a.div(V||(V=Object(P.a)(["\n  display: flex;\n  margin-bottom: 10px;\n  .ant-avatar {\n    margin-right: 8px;\n  }\n  .message-user {\n    font-weight: bold;\n    margin-right: 5px;\n    font-size: 15px;\n  }\n  &.styleRight {\n    margin-left: auto;\n  }\n"]))),Oe=Object(K.a)(he)(S||(S=Object(P.a)(["\n  font-size: 10px;\n"]))),fe=function(e){var t=e.message,n=e.photoURL,a=e.displayName,c=e.createAt,i=e.styleRight;return console.log(i),Object(C.jsxs)(me,{className:i?"styleRight":"",children:[Object(C.jsx)(B.a,{size:30,src:n,children:n?"":null===a||void 0===a?void 0:a.charAt(0).toUpperCase()}),Object(C.jsxs)("div",{className:"message-box",children:[Object(C.jsxs)("div",{className:"message-info",children:[Object(C.jsx)("span",{className:"message-user",children:a}),Object(C.jsx)(Oe,{type:"secondary",children:function(e){if(e){var t=Object(be.a)(new Date(1e3*e),new Date);return t.charAt(0).toUpperCase()+t.slice("1")}}(null===c||void 0===c?void 0:c.seconds)})]}),Object(C.jsx)("span",{className:"message-text",children:t})]})]})},xe=K.a.div(T||(T=Object(P.a)(["\n  height: calc(100% - 66px);\n  display: flex;\n  flex-flow: column;\n  justify-content: flex-end;\n  align-item: flex-end;\n  padding: 0 10px 10px;\n"]))),ve=K.a.div(D||(D=Object(P.a)(["\n  overflow-y: auto;\n  height: 100%;\n  margin-bottom: 3px;\n  display: flex;\n  flex-flow: column;\n  justify-content: flex-end;\n"]))),ge=K.a.div(M||(M=Object(P.a)(["\n  display: flex;\n  .ant-input-affix-wrapper {\n    padding: 3px 5px;\n  }\n"]))),ye=function(){var e=je.a.useForm(),t=Object(Y.a)(e,1)[0],n=Object(a.useContext)(ne).selectedRoomId,c=Object(a.useContext)(H),i=c.displayName,o=c.photoURL,s=c.uid,r=Object(a.useRef)();function l(){var e=t.getFieldValue(["message"]);e&&(t.resetFields(),y("message",{roomId:n,displayName:i,photoURL:o,uid:s,message:e}),r.current.focus())}var u=Object(a.useMemo)((function(){return{fieldName:"roomId",operator:"==",compareValue:n}}),[n]),d=te("message",u);return Object(C.jsxs)(xe,{children:[Object(C.jsx)(ve,{children:d.map((function(e){return Object(C.jsx)(fe,{styleRight:s===e.uid,message:e.message,photoURL:e.photoURL,displayName:e.displayName,createAt:e.createAt},e.id)}))}),Object(C.jsx)(ge,{children:Object(C.jsx)(je.a,{form:t,style:{width:"100%"},onKeyDown:function(e){"Enter"===e.key&&l()},children:Object(C.jsx)(je.a.Item,{name:"message",children:Object(C.jsx)(pe.a,{ref:r,autoFocus:"autofocus",autoComplete:"off",placeholder:"Nh\u1eadp tin nh\u1eafn ...",suffix:Object(C.jsx)(p.a,{type:"primary",onClick:function(){l()},children:"G\u1eedi"})})})})})]})},we=n(283),Ce=K.a.div(z||(z=Object(P.a)(["\n  height: 100vh;\n  padding: 5px;\n"]))),Ne=function(){var e=Object(a.useContext)(ne).selectedRoom;return Object(C.jsx)(Ce,{children:e?Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(de,{}),Object(C.jsx)(ye,{})]}):Object(C.jsx)(we.a,{message:"H\xe3y ch\u1ecdn ph\xf2ng!!",type:"info",closable:!0,showIcon:!0})})},Ie=function(){return Object(C.jsx)("div",{children:Object(C.jsxs)(d.a,{children:[Object(C.jsx)(j.a,{span:6,children:Object(C.jsx)(se,{})}),Object(C.jsx)(j.a,{span:18,children:Object(C.jsx)(Ne,{})})]})})},Re=n(148),Ue=n(280),ke=function(){var e=Object(a.useContext)(ne),t=e.isVisibleAddRoom,n=e.setIsVisibleAddRoom,c=Object(a.useContext)(H).uid,i=je.a.useForm(),o=Object(Y.a)(i,1)[0];function s(){try{o.validateFields(["name","description"]).then((function(e){n(!1),o.resetFields(),y("rooms",Object(g.a)(Object(g.a)({},e),{},{members:[c]}))})).catch((function(e){return console.log(e)}))}catch(e){console.log("Failed:",e)}}return Object(C.jsx)(Ue.a,{title:"Th\xeam ph\xf2ng",visible:t,onOk:function(){s()},onCancel:function(){n(!1)},children:Object(C.jsxs)(je.a,{form:o,layout:"vertical",onKeyDown:function(e){"Enter"===e.key&&s()},children:[Object(C.jsx)(je.a.Item,{name:"name",label:"T\xean ph\xf2ng",rules:[{required:!0,message:"Vui l\xf2ng nh\u1eadp t\xean ph\xf2ng"}],children:Object(C.jsx)(pe.a,{placeholder:"Nh\u1eadp t\xean ph\xf2ng"})}),Object(C.jsx)(je.a.Item,{name:"description",label:"M\xf4 t\u1ea3",rules:[{required:!0,message:"Vui l\xf2ng nh\u1eadp m\xf4 t\u1ea3"}],children:Object(C.jsx)(pe.a,{placeholder:"Nh\u1eadp m\xf4 t\u1ea3"})})]})})},Ae=n(184),Le=n(278),Fe=n(174),Ve=["fetchOptions","debounceTimeout","curMembers","options","setOptions"];function Se(e){var t=e.fetchOptions,n=e.debounceTimeout,c=void 0===n?300:n,i=e.curMembers,o=e.options,s=e.setOptions,r=Object(Ae.a)(e,Ve),l=Object(a.useState)(!1),u=Object(Y.a)(l,2),d=u[0],j=u[1],p=Object(a.useMemo)((function(){return Object(Fe.debounce)((function(e){s([]),j(!0),t(e,i).then((function(e){s(e),j(!1)}))}),c)}),[c,t,i,s]);return Object(a.useEffect)((function(){s([])}),[s]),Object(C.jsx)(Le.a,Object(g.a)(Object(g.a)({labelInValue:!0,filterOption:!1,onSearch:p,notFoundContent:d?Object(C.jsx)(W.a,{size:"small"}):null},r),{},{children:o.map((function(e){var t,n;return Object(C.jsxs)(Le.a.Option,{value:e.value,title:e.label,children:[Object(C.jsx)(B.a,{size:"small",src:e.photoURL,children:e.photoURL?"":null===(t=e.label)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase()})," ".concat(e.label)]},e.value)}))}))}function Te(e){return e.toLowerCase().split(" ").filter((function(e){return""!==e})).join(" ")}function De(e,t){return Me.apply(this,arguments)}function Me(){return(Me=Object(l.a)(r.a.mark((function e(t,n){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Te(t),e.abrupt("return",f.collection("users").where("keywords","array-contains",a).orderBy("displayName").limit(20).get().then((function(e){return e.docs.map((function(e){return{label:e.data().displayName,value:e.data().uid,photoURL:e.data().photoURL}})).filter((function(e){return!n.includes(e.value)}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ze=function(){var e=Object(a.useContext)(ne),t=e.isVisibleInviteUser,n=e.setIsVisibleInviteUser,c=e.selectedRoomId,i=e.selectedRoom,o=Object(a.useState)([]),s=Object(Y.a)(o,2),r=s[0],l=s[1],u=Object(a.useState)([]),d=Object(Y.a)(u,2),j=d[0],p=d[1],b=je.a.useForm(),h=Object(Y.a)(b,1)[0];return Object(C.jsx)(Ue.a,{title:"M\u1eddi th\xeam th\xe0nh vi\xean",visible:t,onOk:function(){h.resetFields(),l([]),p([]),f.collection("rooms").doc(c).update({members:[].concat(Object(v.a)(i.members),Object(v.a)(r.map((function(e){return e.value}))))}),n(!1)},onCancel:function(){h.resetFields(),l([]),p([]),n(!1)},children:Object(C.jsx)(je.a,{form:h,children:Object(C.jsx)(Se,{options:j,setOptions:p,mode:"multiple",name:"search-user",label:"T\xean c\xe1c th\xe0nh vi\xean",value:r,placeholder:"Nh\u1eadp t\xean th\xe0nh vi\xean",fetchOptions:De,onChange:function(e){return l(e)},style:{width:"100%"},curMembers:i?i.members:[]})})})};var Ee=function(){return Object(C.jsx)(Re.a,{children:Object(C.jsx)(Q,{children:Object(C.jsxs)(ae,{children:[Object(C.jsxs)(J.c,{children:[Object(C.jsx)(J.a,{path:"/login",element:Object(C.jsx)(E,{})}),Object(C.jsx)(J.a,{path:"/",element:Object(C.jsx)(Ie,{})})]}),Object(C.jsx)(ke,{}),Object(C.jsx)(ze,{})]})})})},Pe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,287)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),i(e),o(e)}))};o.a.render(Object(C.jsx)(Ee,{}),document.getElementById("root")),Pe()}},[[269,1,2]]]);
//# sourceMappingURL=main.4d9f3a29.chunk.js.map